


<script id="fragment-shader" type = "x-shader/x-fragment"> 
    precision highp float; 

    uniform vec2 viewportDimensions; 
    uniform float left; 
    uniform float right; 
    uniform float bottom; 
    uniform float topBound; 


    void main()
    {
        // [0,1280] -> [-2.0, 2.0] and [0, 720] -> [-2.0, 2.0]
        float a = gl_FragCoord.x / viewportDimensions.x; 
        float b = gl_FragCoord.y / viewportDimensions.y; 
        vec2 c = vec2(left + a * (right-left), bottom + b * (topBound - bottom));

        // Mandelbrot formula
        vec2 z = c; 
        float iterations = 0.0; 
        float maxIterations = 2000.0; 
        const int imaxIterations = 2000; 

        for (int i = 0; i < imaxIterations; i++) {
            // use temp variable t, so we don't overwrite z.y
            float t = 2.0 * z.x * z.y + c.y     // imaginary = (z.x * z.y + z.x + z.y) + c.y
            z.x = z.x * z.x - z.y * z.y + c.x;  // real = z.x * z.x - z.y * z.y + c.x 
            z.y = t;                            // now set z.y 

            if(z.x * z.x + z.y * z.y > 4.0) {
                break;
            }

            iterations += 1.0; 
        }   

        if (iterations < maxIterations) {
            fColor = vec4(1.0, 1.0, 1.0, 1.0); // Not in Mandelbrot set
        }
        else {
            fColor = vec4(0.0, 0.0, 1.0, 1.0); // In Mandelbrot set color blue
        }
    }