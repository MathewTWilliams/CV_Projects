<!DOCTYPE html>
<!--------------------------------------->
<!-- Prof R CV lect 6 Image Processing -->
<!------- Edited by Matt Williams ------->
<!--------------------------------------->

<html>
    <head>
        <h3><b> Point Processing Methods</b></h3>
        <div>
            Warmth -2 <input id="Warmth" type="range" min="-128" max="128" step="1" value="0" /> 2
        </div>
        <div>
            Brightness -2 <input id="Brightness" type="range" min="-128" max="128" step="1" value="0" /> 2
        </div>
        <div>
            Contrast -2 <input id="Contrast" type ="range" min ="0.5" max ="2" step ="0.1" value="1" /> 2
        </div>
        <div>
            Non-Linear Contrast -2 <input id="NL_Contrast" type = "range" min = "0.33" max = "2" step = "0.01" value = 1 /> 2
        </div>
        <div>
            <input id = "Invert" type = "checkbox" value="Invert">
            <label for = "Invert"> Invert colors? </label> 
        </div>

        <h3><b>Minification texture filtering options</b></h3>
        <p id = "Mini_Current"> Currently chosen: Nearest-neightbor mipmapped </p>

        <button id="Mini_Nearest">Nearest-neighbor filtering</button> 
        <button id="Mini_Linear">Linear interpolation filtering</button>
        <button id="Mini_Mip_Nearest">Nearest-neighbor mipmapped filtering</button>
        <button id="Mini_Mip_Linear"> Linear interpolated mipmaps filtering</button>

        <p></p>
        <h3><b>Magnification texture filtering options</b></h3>
        <p id = "Mag_Current">Currently chosen: Nearest-neighbor</p>

        <button id="Mag_Nearest">Nearest-neighbor filtering</button> 
        <button id="Mag_Linear">Linear interpolation filtering</button>

        <p></p>
        <h3>Other </h3>
        <button id="Toggle_Color">Toggle Color/Black&White</button>

        <p></p>


        <script id="vertex-shader" type="x-shader/x-vertex">
            #version 300 es
            
            in  vec2 vPosition;
            in  vec2 vTexCoord;
            out vec2 fTexCoord; 

            uniform mat4 P; 

            void main()
            {
                fTexCoord = vTexCoord; 
                gl_Position = P * vec4(vPosition, 0, 1); 
            }
        </script>

        <script id="fragment-shader" type="x-shader/x-fragment">
            #version 300 es
            precision mediump float; 

            in  vec2 fTexCoord; 
            out vec4 fColor; 

            uniform sampler2D texMap; 
            uniform float warmth; 
            uniform float brightness;
            uniform int invert; 
            uniform int is_color; 
            uniform float contrast;
            uniform float nl_contrast; 

            void main()
            {
                vec4 color = texture(texMap, fTexCoord); //Note texture2d is deprecated in webGL 2.0


                if(is_color == -1) {
                    float i = (color.r + color.g + color.b) / 3.0; 
                    color.rbg = vec3(i,i,i); 

                }
                else {                
                    color.r += warmth;
                    color.b -= warmth; 
                    
                    color.rgb += brightness; 

                    color.rgb *= contrast;
                    
                    color.r = pow(color.r, nl_contrast);
                    color.g = pow(color.g, nl_contrast);
                    color.b = pow(color.b, nl_contrast); 
                
                    if(invert == -1) {
                        color.r = 1.0 - color.r; 
                        color.g = 1.0 - color.g; 
                        color.b = 1.0 - color.b; 
                    }
                }
                fColor = color; 
            }
        </script>

        <script type="text/javascript" src="../Common/initShaders.js"></script>
        <script type="text/javascript" src="../Common/MVnew.js"></script>
        <script type="text/javascript" src="image_processing.js"></script>
    </head>

    <body>
        <canvas id="gl-canvas" width="1280" height="720"> <!---- Set canvas to be 720P -->
            Oops ... your browser doesn't support the HTML5 canvas element
        </canvas>
        <img id="texImage" src="beach.png" hidden></img>
    </body>
</html>